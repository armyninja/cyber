"""
Classes and functions for writing IndicatorRecord objects with record type "MR" (Malware Record)
"""

from pivoteer.writer.core import CsvWriter


class MalwareCsvWriter(CsvWriter):
    """
    A CsvWriter implementation for writing Malware Records in CSV format.
    """

    def __init__(self, writer):
        """
        Create a new CsvWriter for Search Records using the given writer
        :param writer:
        """
        super(MalwareCsvWriter, self).__init__(writer)

    def create_header(self):
        return ["Date", "Source", "Indicator", "MD5", "SHA1", "SHA256", "Report Link"]

    def create_rows(self, record):
        date = record.info_date
        source = record.info_source
        indicator = record.info['indicator']
        md5 = record.info['md5']
        sha1 = record.info['sha1']
        sha256 = record.info['sha256']
        link = record.info['link']
        yield [date, source, indicator, md5, sha1, sha256, link]
